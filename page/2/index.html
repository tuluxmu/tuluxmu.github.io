<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="Front-end engineer。">
<meta property="og:type" content="website">
<meta property="og:title" content="Lucy's Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Lucy's Blog">
<meta property="og:description" content="Front-end engineer。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lucy's Blog">
<meta name="twitter:description" content="Front-end engineer。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Lucy's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?your-analytics-id";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Lucy's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Stay Hungry</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
      
        <li class="menu-item menu-item-search">
          <a href="#" class="st-search-show-outputs">
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'your-swiftype-key','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/Flux-快速上手/" itemprop="url">
                  Flux 快速上手
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:51:34+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/Flux-快速上手/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/Flux-快速上手/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Flux 快速上手</p>
<blockquote>
<p>npm install alt<br>Folder structure</p>
<p>A typical folder structure would look like this</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">your_project&#10;|--actions/&#10;|  |--MyActions.js&#10;|--stores/&#10;|  |--MyStore.js&#10;|--components/&#10;|  |--MyComponent.jsx&#10;|--alt.js&#10;|--app.js</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Creating your first alt</p>
<p>In the root of your project, create a new file called alt.js.</p>
</blockquote>
<p>var Alt = require(‘alt’);<br>var alt = new Alt();</p>
<p>module.exports = alt;</p>
<blockquote>
<p>creating actions</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var alt = require(&#39;../alt&#39;);&#10;&#10;class LocationActions &#123;&#10;     updateLocations(locations) &#123;&#10;     return locations;&#10;     &#125;&#10;&#125;&#10;module.exports = alt.createActions(LocationActions);</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/nodejs初探-搭建一个类似-apache-的服务器/" itemprop="url">
                  nodejs初探 搭建一个类似 apache 的服务器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:44:16+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/nodejs初探-搭建一个类似-apache-的服务器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/nodejs初探-搭建一个类似-apache-的服务器/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#nodejs初探 搭建一个类似 apache 的服务器</p>
<p>#针对于项目而言<br>我们需要明白的是</p>
<ul>
<li>项目大多数的文件都是属于静态文件，只有数据部分存在动态请求。</li>
<li>数据部分的请求都呈现为RESTful的特性。</li>
<li>所以项目主要包含两个部分就是静态服务器和RESTful服务器。<br>###section one :创建一个静态服务器</li>
</ul>
<p>1.创建一个以 app.js 为入口的文件</p>
<p>app.js</p>
<pre>
var PORT = 8000;
var http = require('http');
var server = http.createServer(function (request, response) {
    // TODO
});
server.listen(PORT);
console.log("Server runing at port: " + PORT + ".");
</pre>
###静态文件服务器的功能:

* 浏览器发送URL，服务端解析URL，对应到硬盘上的文件。
* 如果文件存在，返回200状态码，并发送文件到浏览器端；如果文件不存在，返回404状态码，发送一个404的文件到浏览器端。

### section two :实现路由的功能

* 添加url模块是必要的，然后解析pathname。

以下是实现代码：

<pre>
var server = http.createServer(function (request, response) {
    var pathname = url.parse(request.url).pathname;
    response.write(pathname);
    response.end();
});

</pre>

<p>###读取静态文件</p>
<p>为了不让用户在浏览器端通过请求/app.js查看到我们的代码，我们设定用户只能请求assets目录下的文件。<br>服务器会将路径信息映射到assets目录。</p>
<p>文件读取就跟fs(file system)这个模块有关系。<br>同样，涉及到了路径处理，path模块也是需要的。</p>
<p>我们通过path模块的path.exists方法来判断静态文件是否存在磁盘上。<br>加入不存在我们直接响应给客户端404错误。</p>
<p>如果文件存在则调用fs.readFile方法读取文件。<br>如果发生错误，我们响应给客户端500错误，表明存在内部错误。<br>正常状态下则发送读取到的文件给客户端，表明200状态。</p>
<pre>
var server = http.createServer(function (request, response) {
    var pathname = url.parse(request.url).pathname;
    var realPath = "assets" + pathname;
    path.exists(realPath, function (exists) {
        if (!exists) {
            response.writeHead(404, {
                'Content-Type': 'text/plain'
            });

            response.write("This request URL " + pathname + " was not found on this server.");
            response.end();
        } else {
            fs.readFile(realPath, "binary", function (err, file) {
                if (err) {
                    response.writeHead(500, {
                        'Content-Type': 'text/plain'
                    });

                    response.end(err);
                } else {
                    response.writeHead(200, {
                        'Content-Type': 'text/html'
                    });

                    response.write(file, "binary");

                    response.end();
                }
            });
        }
    });
});
</pre>

<p>以上这段简单的代码加上一个assets目录，就构成了我们最基本的静态文件服务器。</p>
<p>那么眼尖的你且看看，这个最基本的静态文件服务器存在哪些问题呢？<br>答案是MIME类型支持。因为我们的服务器同时要存放html, css, js, png, gif, jpg等等文件。<br>并非每一种文件的MIME类型都是text/html的。</p>
<p>###MIME类型支持</p>
<p>像其他服务器一样，支持MIME的话，就得一张映射表。</p>
<pre>

exports.types = {
    "css": "text/css",
    "gif": "image/gif",
    "html": "text/html",
    "ico": "image/x-icon",
    "jpeg": "image/jpeg",
    "jpg": "image/jpeg",
    "js": "text/javascript",
    "json": "application/json",
    "pdf": "application/pdf",
    "png": "image/png",
    "svg": "image/svg+xml",
    "swf": "application/x-shockwave-flash",
    "tiff": "image/tiff",
    "txt": "text/plain",
    "wav": "audio/x-wav",
    "wma": "audio/x-ms-wma",
    "wmv": "video/x-ms-wmv",
    "xml": "text/xml"
};I</pre>
以上代码另存在mime.js文件中。

我们要做的是引入这个 MIME.js 文件。
< pre>
var mime = require("./mime").types;

我们通过path.extname来获取文件的后缀名。由于extname返回值包含”.”，所以通过slice方法来剔除掉”.”，对于没有后缀名的文件，我们一律认为是unknown。
<pre>
var ext = path.extname(realPath);
ext = ext ? ext.slice(1) : 'unknown';
</pre>
接下来我们很容易得到真正的MIME类型了。
<pre>
var contentType = mime[ext] || "text/plain";
response.writeHead(200, {'Content-Type': contentType});
response.write(file, "binary");
response.end();
</pre>
对于未知的类型，我们一律返回text/plain类型。

###缓存支持/控制

在MIME支持之后，静态文件服务器看起来已经很完美了。
任何静态文件只要丢进assets目录之后就可以万事大吉不管了。
看起来已经达到了Apache作为静态文件服务器的相同效果了。

*但是，我们发现用户在每次请求的时候，服务器每次都要调用fs.readFile方法去读取硬盘上的文件的。当服务器的请求量一上涨，硬盘IO会吃不消。*
在解决这个问题之前，
###我们有必要了解一番前端浏览器缓存的一些机制和提高性能的方案。

* GZip压缩文件可以减少响应的大小，能够达到节省带宽的目的。
* 浏览器缓存中存有文件副本的时候，不能确定有效的时候，会生成一个条件get请求。
* 在请求的头中会包含 If-Modified-Since。
* 如果服务器端文件在这个时间后发生过修改，则发送整个文件给前端。
* 如果没有修改，则返回304状态码。并不发送整个文件给前端。
* 如果副本有效，这个get请求都会省掉。判断有效的最主要的方法是服务端响应的时候带上Expires的头。
* 浏览器会判断Expires头，直到制定的日期过期，才会发起新的请求。
*另一个可以达到相同目的的方法是返回Cache-Control: max-age=xxxx。*

为了简化问题，我们只做如下这几件事情：

为指定几种后缀的文件，在响应时添加Expires头和Cache-Control: max-age头。超时日期设置为1年。
由于这是静态文件服务器，为所有请求，响应时返回Last-Modified头。
为带If-Modified-Since的请求头，做日期检查，如果没有修改，则返回304。若修改，则返回文件。
对于以上的静态文件服务器，Node给的响应头是十分简单的：
<pre>
Connection: keep-alive
Content-Type: text/html
Transfer-Encoding: chunked
<pre>
对于指定后缀文件和过期日期，为了保证可配置。那么建立一个config.js文件是应该的。
<pre>
exports.Expires = {
    fileMatch: /^(gif|png|jpg|js|css)$/ig,
    maxAge: 60 * 60 * 24 * 365
};
</pre>
引入config.js文件。

<pre>var config = require("./config");</pre>
我们在相应之前判断后缀名是否符合我们要添加过期时间头的条件。
<pre>
var ext = path.extname(realPath);
ext = ext ? ext.slice(1) : 'unknown';
if (ext.match(config.Expires.fileMatch)) {
    var expires = new Date();
    expires.setTime(expires.getTime() + config.Expires.maxAge * 1000);
    response.setHeader("Expires", expires.toUTCString());
    response.setHeader("Cache-Control", "max-age=" + config.Expires.maxAge);
}
</pre>
这次的响应头中多了两个header。
<pre>
Cache-Control: max-age=31536000
Connection: keep-alive
Content-Type: image/png
Expires: Fri, 09 Nov 2012 12:55:41 GMT
Transfer-Encoding: chunked
<pre>
浏览器在发送请求之前由于检测到Cache-Control和Expires
*（Cache-Control的优先级高于Expires，但有的浏览器不支持Cache-Control，这时采用Expires）*，如果没有过期，则不会发送请求，而直接从缓存中读取文件。

接下来我们为所有请求的响应都添加Last-Modified头。

读取文件的最后修改时间是通过fs模块的fs.stat()方法来实现的。

<pre>
fs.stat(realPath, function (err, stat) {
    var lastModified = stat.mtime.toUTCString();
    response.setHeader("Last-Modified", lastModified);
});
</pre>
我们同时也要检测浏览器是否发送了If-Modified-Since请求头。如果发送而且跟文件的修改时间相同的话，我们返回304状态。

if (request.headers[ifModifiedSince] && lastModified == request.headers[ifModifiedSince]) {
    response.writeHead(304, "Not Modified");
    response.end();
}
如果没有发送或者跟磁盘上的文件修改时间不相符合，则发送回磁盘上的最新文件。

通过Expires和Last-Modified两个方案以及与浏览器之间的通力合作，会节省相当大的一部分网络流量，同时也会降低部分硬盘IO的请求。如果在这之前还存在CDN的话，整个方案就比较完美了。

由于Expires和Max-Age都是由浏览器来进行判断的，如果判断成功，http请求都不会发送到服务端的，这里只能通过fiddler和浏览器配合进行测试。但是Last-Modified却是可以通过curl来进行测试的。
<pre>
curl --header "If-Modified-Since: Fri, 11 Nov 2011 19:14:51 GMT" -i http://localhost:8000

HTTP/1.1 304 Not Modified
Content-Type: text/html
Last-Modified: Fri, 11 Nov 2011 19:14:51 GMT
Connection: keep-alive
</pre>
*注意，我们看到这个304请求的响应是不带body信息的。所以，达到我们节省带宽的需求。只需几行代码，就可以省下许多的带宽费用。*

###GZip启用
*可以减少流量和带宽*
######要用到gzip，就需要zlib模块，该模块在Node的0.5.8版本开始原生支持。

<pre>var zlib = require("zlib");</pre>

<p>对于图片一类的文件，不需要进行gzip压缩，所以我们在config.js中配置一个启用压缩的列表。</p>
<pre>
exports.Compress = {
    match: /css|js|html/ig
};
</pre>
这里为了防止大文件，也为了满足zlib模块的调用模式，将读取文件改为流的形式进行读取。
<pre>
var raw = fs.createReadStream(realPath);
var acceptEncoding = request.headers['accept-encoding'] || "";
var matched = ext.match(config.Compress.match);
if (matched && acceptEncoding.match(/\bgzip\b/)) {
    response.writeHead(200, "Ok", {
        'Content-Encoding': 'gzip'
    });
    raw.pipe(zlib.createGzip()).pipe(response);
} else if (matched && acceptEncoding.match(/\bdeflate\b/)) {
    response.writeHead(200, "Ok", {
        'Content-Encoding': 'deflate'
    });
    raw.pipe(zlib.createDeflate()).pipe(response);
} else {
    response.writeHead(200, "Ok");
    raw.pipe(response);
}
</pre>

<p>###Welcome页的锦上添花</p>
<p>再来回忆一下Apache的常见行为。</p>
<ul>
<li>当进入一个目录路径的时候，会去寻找index.html页面，如果index.html文件不存在，则返回目录索引。</li>
<li>目录索引这里我们暂不考虑，如果用户请求的路径是/结尾的，我们就自动为其添加上index.html文件。</li>
<li>如果这个文件不存在，继续返回404错误。</li>
<li>如果用户请求了一个目录路径，而且没有带上/。那么我们为其添加上/index.html，再重新做解析。</li>
</ul>
<p>那么不喜欢硬编码的你，肯定是要把这个文件配置进config.js。这样你就可以选择各种后缀作为welcome页面。</p>
<p>exports.Welcome = {<br>    file: “index.html”<br>};<br>那么第一步，为/结尾的请求，自动添加上”index.html”。</p>
<p>if (pathname.slice(-1) === “/“) {<br>    pathname = pathname + config.Welcome.file;<br>}<br>第二步，如果请求了一个目录路径，并且没有以/结尾。那么我们需要做判断。如果当前读取的路径是目录，就需要添加上/和index.html</p>
<p>if (stats.isDirectory()) {<br>    realPath = path.join(realPath, “/“, config.Welcome.file);<br>}<br>由于我们目前的结构发生了一点点变化。所以需要重构一下函数。而且，fs.stat方法具有比fs.exsits方法更多的功能。我们直接替代掉它。</p>
<p>就这样。一个各方面都比较完整的静态文件服务器就这样打造完毕。</p>
</pre></pre></pre></pre>
          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/node-js-在node-js中连接MongoDB/" itemprop="url">
                  node.js 在node.js中连接MongoDB
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:42:38+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/node-js-在node-js中连接MongoDB/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/node-js-在node-js中连接MongoDB/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#node.js 在node.js中连接MongoDB<br>对MongoDB的操作我们已经有一定程度的了解，接下来我们就要把MongoDB的资料显示到网页上。</p>
<p>为了让Node.js能够连结MongoDB，我们要在package.json里加入一些模块。打开package.json，请在”dependencies”段的结尾加入：</p>
<pre>
"mongodb": "*",
"monk": "*"
</pre>
以下是package.json的完整程序：
<pre>
{
  "name": "testproject",
  "version": "0.0.0",
  "private": true,
  "scripts": {
    "start": "nodemon ./bin/www"
  },
  "dependencies": {
    "express": "~4.8.6",
    "body-parser": "~1.6.6",
    "cookie-parser": "~1.3.2",
    "morgan": "~1.2.3",
    "serve-favicon": "~2.0.1",
    "debug": "~1.0.4",
    "hjs": "~0.0.6",
    "less-middleware": "1.0.x",
    "mongodb": "*",
    "monk": "*"
  }
}
</pre>
接着在*这个目录*打开命令视窗，执行以下指令：
<pre>npm install</pre>

<p>这样新的模块就安装成功了。我们一共新增了两个模块，第一个是”mongodb”，使node.js可以使用MongoDB；第二个”monk”是用来连结MongoDB的，它的好处是简单易用，适合新手。跟”monk”类似的模块有”mongoose”，”mongoose”比”monk”更强，更复雑，等到你对MongoDB的了解更深时，或许便会用到”mongoose”，现在的话”monk”已经够用。</p>
<p>模块安装成功后，要让我们的项目使用，打开”app.js”，在第一部分的”var”段结尾加入：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// Connect to MongoDB&#10;var mongo = require(&#39;mongodb&#39;);&#10;var monk = require(&#39;monk&#39;);&#10;var db = monk(&#39;localhost:27017/testproject&#39;);</span><br></pre></td></tr></table></figure>
<p>这里的意思是我们用”monk”来连结MongoDB，服务器位置是”localhost”，port是”27017″(MongoDB预设)，数据库名称为”testproject”。</p>
<p>接下来我们要让路由程序”router”可以使用数据库，在app.js里找到：</p>
<p><pre><br>app.use(‘/‘, routes);<br>app.use(‘/users’, users);<br></pre><br>在这两行前面加入：</p>
<p><pre><br>// Allow router to access db<br>app.use(function(req,res,next){<br>    req.db = db;<br>    next();<br>});<br></pre><br>这段程序的意思将我们刚刚用”monk”连结的”db”赋值给”req.db”，这样在”router”里面也能通过”req.db”来操作数据库。</p>
<p>至此Node.js与MongoDB的连结就搭好了。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/ReactJs与浏览器之间的运作原理/" itemprop="url">
                  ReactJs与浏览器之间的运作原理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:37:25+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/ReactJs与浏览器之间的运作原理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/ReactJs与浏览器之间的运作原理/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#ReactJs与浏览器之间的运作原理<br>React 针对浏览器提供了十分强大的抽象化概念，让你在大部份的情况下不必再直接操作 DOM ，不过有些时候或许还是需要单纯的存取底层的 API(DOM API)，可能是使用第三方函式库或者是已经写好的程序码。</p>
<p>##关于虚拟 DOM<br>React 快速的原因是因为它从来不直接影响 DOM。<br>React 会负责在存储器中持续维护一份 DOM 的表现结构。<br>render() 方法负责回传关于 DOM 的描速，React 就能得知其和存储器中结构的差异，接着他会计算出最快的更新方式然后交给浏览器去影响 DOM。<br>此外，React 完整实作了对应的事件系统，所有物件的事件保证符合 W3C 的规范，且关于事件气泡传递(bubbles)的行为在任何浏览器也都一致。<br>甚至可以在 IE8 使用 HTML5 的事件。<br>大多数的时候你的程序操作应该都会 React 所建构的”仿浏览器”的世界里，因为它俱有高效能和相对容易使用。<br>不过有些情况下，你可能会需要存取使用底层基本的 API，例如使用 jQuery 第三方套件，React 提供了一个后门允许你可以直接操作底层的 API。</p>
<h1 id="Refs__u548C_getDOMNode_28_29"><a href="#Refs__u548C_getDOMNode_28_29" class="headerlink" title="Refs 和 getDOMNode()"></a>Refs 和 getDOMNode()</h1><p>为了与浏览器互动，你需要使用指向 DOM 节点的参考物件。<br>每一个 Mounted 的 React 元件都会有 getDOMNode() 的功能 ，你可以透过呼叫它取得该 DOM 的参考物件。<br>注意：getDOMNode() 只能在元件已经挂载完毕时使用(换句话说这表示该物件已经被渲染放置到 DOM 里了)。如果你尝试在元件尚未挂载完毕前呼叫这个 API 将会发生例外。<br>为了取得 React 元件的参考，你可以使用 this 取得目前元件或者使用 refs，使用 refs 则需要设定一个名称，如下范例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/** @jsx React.DOM */&#10;&#10;var MyComponent = React.createClass(&#123;&#10;  handleClick: function() &#123;&#10;    // &#36879;&#36807;&#21407;&#29983; API &#26126;&#30830;&#30340;&#25351;&#31034; input &#20026; focus &#29366;&#24577;&#12290;&#10;    this.refs.myTextInput.getDOMNode().focus();&#10;  &#125;,&#10;  render: function() &#123;&#10;    // ref &#23646;&#24615;&#26367;&#20803;&#20214;&#22686;&#21152;&#19968;&#20010;&#21442;&#32771;&#28982;&#21518;&#20320;&#23601;&#21487;&#20197;&#22312;&#20803;&#20214;&#25346;&#36733;&#23436;&#27605;&#21518;&#20351;&#29992; `this.refs`&#10;    return (&#10;      &#60;div&#62;&#10;        &#60;input type=&#34;text&#34; ref=&#34;myTextInput&#34; /&#62;&#10;        &#60;input&#10;          type=&#34;button&#34;&#10;          value=&#34;Focus the text input&#34;&#10;          onClick=&#123;this.handleClick&#125;&#10;        /&#62;&#10;      &#60;/div&#62;&#10;    );&#10;  &#125;&#10;&#125;);&#10;&#10;React.renderComponent(&#10;  &#60;MyComponent /&#62;,&#10;  document.getElementById(&#39;example&#39;)&#10;);</span><br></pre></td></tr></table></figure>
<p>#元件的生命周期</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#20803;&#20214;&#30340;&#29983;&#21629;&#21608;&#26399;&#26377;&#19977;&#20010;&#20027;&#35201;&#30340;&#37096;&#20998;&#65306;&#10;&#62; &#61623;Mounting&#65306;&#20803;&#20214;&#27491;&#20934;&#22791;&#35201;&#34987;&#20889;&#20837; DOM&#10;&#62; &#61623;Updating&#65306;&#20803;&#20214;&#20390;&#27979;&#21040;&#29366;&#24577;&#30340;&#25913;&#21464;&#20934;&#22791;&#37325;&#26032;&#28210;&#26579;&#12290;&#10;&#62; &#61623;Unmounting&#65306;&#20803;&#20214;&#27491;&#35201;&#34987;&#20174; DOM &#20013;&#31227;&#38500;&#12290;&#10;React &#26681;&#25454;&#29983;&#21629;&#21608;&#26399;&#25552;&#20379;&#20102;&#23545;&#24212;&#30340;&#26041;&#27861;(&#20107;&#20214;)&#35753;&#20320;&#21487;&#20197;&#22312;&#23545;&#24212;&#30340;&#38454;&#27573;&#20570;&#19968;&#20123;&#22788;&#29702;&#12290;&#10;Will &#30340;&#26041;&#27861;&#29992;&#22312;&#26576;&#20123;&#29366;&#20917;&#20934;&#22791;&#21457;&#29983;&#20043;&#21069;&#65292;Did &#30340;&#26041;&#27861;&#21017;&#34920;&#31034;&#35813;&#29366;&#20917;&#24050;&#32463;&#21457;&#29983;&#21518;&#12290;&#10;Mounting &#25346;&#36733;&#27969;&#31243;&#10;&#61623;getInitialState()&#65306;&#24403;&#29289;&#20214;&#34987;&#35843;&#29992;&#26102;&#27492;&#26041;&#27861;&#20250;&#22312;&#20889;&#20837; DOM &#20043;&#21069;&#34987;&#35302;&#21457;&#65292;&#36890;&#24120;&#29992;&#26469;&#31649;&#29702;&#29366;&#24577;&#30340;&#20803;&#20214;&#21487;&#20197;&#29992;&#36825;&#20010;&#26041;&#27861;&#21021;&#22987;&#21270;&#19968;&#20123;&#36164;&#26009;&#12290;&#10;&#61623;componentWillMount&#65306;&#24403;&#20803;&#20214;&#20869;&#37096;&#30340;&#32467;&#26500;&#22788;&#29702;&#23436;&#27605;&#20934;&#22791;&#20889;&#20837; DOM &#20043;&#21069;&#35302;&#21457;&#12290;&#10;&#61623;componentDidMount(DOMElement rootNode)&#65306;&#24403;&#20803;&#20214;&#34987;&#20889;&#20837; DOM &#20043;&#21518;&#35302;&#21457;&#12290;&#24403;&#21021;&#22987;&#21270;&#38656;&#35201;&#25805;&#20316; DOM &#20803;&#32032;&#23601;&#21487;&#20197;&#29992;&#36825;&#20010;&#26041;&#27861;&#12290;&#10;Updating &#26356;&#26032;&#27969;&#31243;&#10;&#61623;componentWillReceiveProps(nextProps)&#65306;&#24050;&#25346;&#36733;&#30340;&#20803;&#20214;&#25910;&#21040;&#26032;&#30340; props &#26102;&#34987;&#35302;&#21457;&#12290;&#22312;&#36825;&#20010;&#26041;&#27861;&#37324;&#20320;&#36890;&#24120;&#20250;&#21435;&#27604;&#36739; this.props &#21644; nextProps &#28982;&#21518;&#20877;&#29992; this.setState &#21435;&#25913;&#21464;&#29366;&#24577;&#12290;&#10;&#61623;shouldComponentUpdate(nextProps, nextState)&#65306;&#36825;&#20010;&#20989;&#24335;&#38656;&#35201;&#22238;&#20256;&#19968;&#20010;&#24067;&#23572;&#20540;&#65292;&#24403;&#20803;&#20214;&#21028;&#26029;&#26159;&#21542;&#38656;&#35201;&#26356;&#26032; DOM &#26102;&#20250;&#34987;&#35302;&#21457;&#12290;&#20320;&#21487;&#20197;&#22312;&#36825;&#20010;&#26041;&#27861;&#37324;&#38754;&#21435;&#27604;&#36739; this.props&#65292;this.state&#65292;nextProps&#65292;nextState &#26469;&#20915;&#23450;&#26159;&#21542;&#38656;&#35201;&#26356;&#26032;&#65292;&#22238;&#20256; false &#21017;&#20250;&#36339;&#36807;&#27492;&#27425;&#35302;&#21457;&#19981;&#26356;&#26032;&#65292;&#22914;&#26524;&#20320;&#20160;&#20040;&#37117;&#19981;&#22238;&#20256;&#39044;&#35774;&#20250;&#24403;&#20570; false &#12290;&#10;&#61623;componentWillUpdate&#65306;&#20363;&#22914;&#22312;&#19978;&#38754; shouldComponentUpdate &#20320;&#22238;&#20256;&#20102; true &#65292;&#20803;&#20214;&#30830;&#23450;&#35201;&#26356;&#26032;&#20102;&#65292;&#22312;&#20934;&#22791;&#26356;&#26032;&#21069;&#36825;&#20010;&#26041;&#27861;&#20250;&#34987;&#35302;&#21457;&#12290;&#10;&#61623;componentDidupdate(prevProps, prevState, rootNode)&#65306;&#26356;&#26032;&#21518;&#35302;&#21457;&#12290;&#10;Unmounting &#21368;&#36733;&#27969;&#31243;&#10;&#61623;componentWillUnmount()&#65306;&#24403;&#20803;&#20214;&#20934;&#22791;&#35201;&#34987;&#31227;&#38500;&#25110;&#30772;&#22351;&#26102;&#35302;&#21457;&#12290;&#10;&#25346;&#36733;&#21518;&#25165;&#33021;&#20351;&#29992;&#30340;&#26041;&#27861;&#10;&#61623;getDOMNode()&#65306;&#20351;&#29992;&#27492;&#26041;&#27861;&#20250;&#20256;&#22238;&#19968;&#20010; DOM &#20803;&#32032;&#29289;&#20214;&#65292;&#36879;&#36807;&#36825;&#20010;&#26041;&#27861;&#20320;&#21487;&#20197;&#21462;&#24471;&#19968;&#20010;&#21442;&#32771;&#29289;&#20214;&#30452;&#25509;&#25805;&#20316; DOM &#33410;&#28857;&#12290;&#10;&#61623;forceUpdate()&#65306;&#20219;&#20309;&#24050;&#25346;&#36733;&#30340;&#20803;&#20214;&#65292;&#24403;&#20320;&#30693;&#36947;&#20803;&#20214;&#20869;&#37096;&#26377;&#20123;&#29366;&#24577;&#24050;&#32463;&#25913;&#21464;&#20294;&#20182;&#19981;&#26159;&#36879;&#36807; this.setState() &#21435;&#20462;&#25913;&#20540;&#30340;&#26102;&#20505;&#21487;&#20197;&#21628;&#21483;&#36825;&#20010;&#26041;&#27861;&#24378;&#36843;&#26356;&#26032;&#12290;&#10;&#27880;&#24847;&#65306;componentDidMount() &#21644; componentDidUpdate() &#30340; rootNode &#21442;&#25968;&#21482;&#26159;&#25552;&#20379;&#20320;&#19968;&#20010;&#27604;&#36739;&#26041;&#20415;&#30340;&#26041;&#24335;&#23384;&#21462; DOM &#65292;&#36825;&#21644;&#20351;&#29992; this.getDOMNode() &#26159;&#19968;&#26679;&#30340;&#12290;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/** @jsx React.DOM */var Test = React.createClass(&#123;&#10;  getInitialState: function () &#123;&#10;    console.log(&#34;&#62; getInitialState()&#34;);&#10;    return &#123;user: &#39;AndyYou&#39;&#125;;&#10;  &#125;,&#10;  componentWillMount: function () &#123;&#10;    console.log(&#34;&#62; componentWillMount()&#34;);&#10;  &#125;,&#10;  componentDidMount: function (node) &#123;&#10;    console.log(&#34;&#62; componentDidMount(node)&#34;);&#10;    console.log(node.className);&#10;    console.log(node.value);&#10;    console.log(node.id);&#10;    console.log(this.getDOMNode().className);&#10;    console.log(this.getDOMNode().value);&#10;    console.log(this.getDOMNode().id);&#10;  &#125;,&#10;  componentWillReceiveProps: function (nextProps) &#123;&#10;    console.log(&#34;&#62; componentWillReceiveProps(nextProps)&#34;);&#10;    console.log(nextProps);&#10;  &#125;,&#10;  handleChange: function (e) &#123;&#10;    console.log(e.target.value);&#10;    this.setState(&#123;user: e.target.value&#125;);&#10;  &#125;,&#10;  shouldComponentUpdate: function (nextProps, nextState) &#123;&#10;    console.log(&#34;&#62; shouldComponentUpdate(nextProps, nextState)&#34;);&#10;    console.log(&#34;nextProps: &#34;);&#10;    console.log(nextProps);&#10;    console.log(&#34;nextState: &#34;);&#10;    console.log(nextState);&#10;    return true; /* need return true/false */&#10;  &#125;,&#10;  componentWillUpdate: function (nextProps, nextState) &#123;&#10;    console.log(&#34;&#62; componentWillUpdate(nextProps, nextState)&#34;);&#10;  &#125;,&#10;  componentWillUnmount: function () &#123;&#10;    console.log(&#34;&#62; componentWillUnmount()&#34;);&#10;  &#125;,&#10;  render: function () &#123;&#10;    return (&#10;      &#60;input type=&#39;text&#39; id=&#39;foobar&#39; value=&#123;this.state.user&#125; className=&#39;nav&#39; onChange=&#123;this.handleChange&#125; /&#62;&#10;    );&#10;  &#125;&#125;);var test = React.renderComponent(&#60;Test title=&#39;Untitled&#39; /&#62;, document.getElementById(&#39;example&#39;));// test.setProps(&#123;title: &#39;No&#39;&#125;);&#10;// React.unmountComponentAtNode(document.getElementById(&#39;example&#39;));// test.setState(&#123;user:&#39;Calvert&#39;&#125;);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/React-TABS/" itemprop="url">
                  React TABS
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:33:37+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/React-TABS/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/React-TABS/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#React TABS</p>
<p>##1-show the demo</p>
<p>##2-how it works<br>I create a component with React .<br>and the first thing i thought is that how to use this component which of the API is .</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;&#60;TabsControl&#62;&#10;  &#60;Tab name=&#34;red&#34;&#62;&#10;    &#60;div className=&#34;red&#34;/&#62;&#10;  &#60;/Tab&#62;&#10;  &#60;Tab name=&#34;blue&#34;&#62;&#10;    &#60;div className=&#34;blue&#34;/&#62;&#10;  &#60;/Tab&#62;&#10;  &#60;Tab name=&#34;yellow&#34;&#62;&#10;    &#60;div className=&#34;yellow&#34;/&#62;&#10;  &#60;/Tab&#62;&#10;&#60;/TabsControl&#62;</span><br></pre></td></tr></table></figure>
<p>the TabsControl as a parent component, it can control the switch of Tabs and show the content in it , the attribute of Name is the title of the tab-page and it will show on the title-bar .</p>
<p>##3-create the basic element<br>1.map the {this.props.children}<br>the attr this.props.children can get the children element.<br>Cause the children element has many states , like Object or Array , React use a way to map the children element.</p>
<p>#React.Children.map#<br>so,the code is :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;React.Children.map(this.props.children, (element, index) =&#62; &#123;&#10;    return (&#60;div className=&#34;tab-title-item&#34;&#62;&#123;element.props.name&#125;&#60;/div&#62;)</span><br></pre></td></tr></table></figure>
<p>2.we use the same way to create the content of tab</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;React.Children.map(this.props.children, element =&#62; &#123;&#10;    return (element)&#10;&#125;)</span><br></pre></td></tr></table></figure>
<p>and we combine them .</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;let TabsControl = React.createClass(&#123;&#10;  render: function () &#123;&#10;    let that = this;&#10;    let &#123;baseWidth&#125; = this.props;&#10;    let childrenLength = this.props.children.length;&#10;    return (&#10;      &#60;div&#62;&#10;        &#60;nav className=&#34;tab-title-items&#34;&#62;&#10;          &#123;React.Children.map(this.props.children, (element, index) =&#62; &#123;&#10;            return (&#60;div className=&#34;tab-title-item&#34;&#62;&#123;element.props.name&#125;&#60;/div&#62;)&#10;          &#125;)&#125;&#10;        &#60;/nav&#62;&#10;        &#60;div className=&#34;tab-content-items&#34;&#62;&#10;          &#123;React.Children.map(this.props.children, element =&#62; &#123;&#10;            return (element)&#10;          &#125;)&#125;&#10;        &#60;/div&#62;&#10;      &#60;/div&#62;&#10;    )&#10;  &#125;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>We add some css ,and the Tab is created.<br>4-let the tab has its function of switch.<br>There has a most important idea , that is STATE.<br>the STATE is a Object in Javascript , it stands up the current state of the tab.<br>For example , we click the 2nd tab , and the state ==2;</p>
<h2 id="everythime_when_we_call_the_setState_28_29_2Cwe_will_trigger_the_render_28_29"><a href="#everythime_when_we_call_the_setState_28_29_2Cwe_will_trigger_the_render_28_29" class="headerlink" title="everythime when we call the setState(),we will trigger the render()."></a>everythime when we call the setState(),we will trigger the render().</h2><p>that is the DOM of the tab will update the state .</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;let TabsControl = React.createClass(&#123;&#10;  getInitialState: function()&#123;&#10;    return &#123;currentIndex: 0&#125;&#10;  &#125;,&#10;&#10;  getTitleItemCssClasses: function(index)&#123;&#10;    return index === this.state.currentIndex ? &#34;tab-title-item active&#34; : &#34;tab-title-item&#34;;&#10;  &#125;,&#10;&#10;  getContentItemCssClasses: function(index)&#123;&#10;    return index === this.state.currentIndex ? &#34;tab-content-item active&#34; : &#34;tab-content-item&#34;;&#10;  &#125;,&#10;&#10;  render: function()&#123;&#10;    let that = this;&#10;    let &#123;baseWidth&#125; = this.props;&#10;    let childrenLength = this.props.children.length;&#10;    return (&#10;      &#60;div&#62;&#10;        &#60;nav className=&#34;tab-title-items&#34;&#62;&#10;          &#123;React.Children.map(this.props.children, (element, index) =&#62; &#123;&#10;            return (&#60;div onClick=&#123;() =&#62; &#123;this.setState(&#123;currentIndex: index&#125;)&#125;&#125; className=&#123;that.getTitleItemCssClasses(index)&#125;&#62;&#123;element.props.name&#125;&#60;/div&#62;)&#10;          &#125;)&#125;&#10;        &#60;/nav&#62;&#10;        &#60;div className=&#34;tab-content-items&#34;&#62;&#10;          &#123;React.Children.map(this.props.children, (element, index) =&#62; &#123;&#10;            return (&#60;div className=&#123;that.getContentItemCssClasses(index)&#125;&#62;&#123;element&#125;&#60;/div&#62;)&#10;          &#125;)&#125;&#10;        &#60;/div&#62;&#10;      &#60;/div&#62;&#10;    )&#10;  &#125;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>getInitialState：the initial state , it defaults the 1st element is the active state.<br>getTitleItemCssClasses &amp; getContentItemCssClasses to find the selected tab and it makes different from others.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">onClick=&#123;() =&#62; &#123;this.setState(&#123;currentIndex: index&#125;)&#125;&#125;&#65306;bind the click event , and it triggers the render().</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/Closure/" itemprop="url">
                  Closure
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:32:16+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/Closure/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/Closure/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Closure<br>a most important idea.<br>1-to master the closure.<br>the first thing i do is find the demo code.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;function A()&#123;&#10;    function B()&#123;&#10;       console.log(&#34;Hello Closure!&#34;);&#10;    &#125;&#10;    return B;&#10;&#125;&#10;var c = A();&#10;c();//Hello Closure!</span><br></pre></td></tr></table></figure>
<p>the above is the most simple demo.<br>we analyze the code , and we will find that :<br>1-define a function A.<br>2-In A , define a function B.<br>3-In A , return B .<br>4-execute A(),and the return value == c ;<br>5-execute C().<br>In a word , In function A ,there has a function B.<br>and we use var C to execute function B();<br>2-the function of the Closure</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;function A()&#123;&#10;    var count = 0;&#10;    function B()&#123;&#10;       count ++;&#10;       console.log(count);&#10;    &#125;&#10;    return B;&#10;&#125;&#10;var c = A();&#10;c();// 1&#10;c();// 2&#10;c();// 3</span><br></pre></td></tr></table></figure>
<p>3-</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;(function(document)&#123;&#10;    var viewport;&#10;    var obj = &#123;&#10;        init:function(id)&#123;&#10;           viewport = document.querySelector(&#34;#&#34;+id);&#10;        &#125;,&#10;        addChild:function(child)&#123;&#10;            viewport.appendChild(child);&#10;        &#125;,&#10;        removeChild:function(child)&#123;&#10;            viewport.removeChild(child);&#10;        &#125;&#10;    &#125;&#10;    window.jView = obj;&#10;&#125;)(document);</span><br></pre></td></tr></table></figure>
<p>4-</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;var f = function(document)&#123;&#10;    var viewport;&#10;    var obj = &#123;&#10;        init:function(id)&#123;&#10;            viewport = document.querySelector(&#34;#&#34;+id);&#10;        &#125;,&#10;        addChild:function(child)&#123;&#10;            viewport.appendChild(child);&#10;        &#125;,&#10;        removeChild:function(child)&#123;&#10;            viewport.removeChild(child);&#10;        &#125;&#10;    &#125;&#10;    window.jView = obj;&#10;&#125;;&#10;f(document);</span><br></pre></td></tr></table></figure>
<p>#window.jView = obj; refs to the meaning of Closure.</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/how-to-make-a-good-front-end-developer/" itemprop="url">
                  how to make a good front-end developer
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:30:38+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/how-to-make-a-good-front-end-developer/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/how-to-make-a-good-front-end-developer/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#how to make a good front-end developer</p>
<p>##1-troduce myself to other people</p>
<p>##2-make friends with those who are better than you</p>
<p>##3-balance your life and your work</p>
<p>##4-take a charge of your work</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/Improve-Nested-Conditionals/" itemprop="url">
                  Improve Nested Conditionals
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:28:43+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/Improve-Nested-Conditionals/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/Improve-Nested-Conditionals/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##Improve Nested Conditionals<br>How can we improve and make more efficient nested if statement in javascript.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;if (color) &#123;&#10;  if (color === &#39;black&#39;) &#123;&#10;    printBlackBackground();&#10;  &#125; else if (color === &#39;red&#39;) &#123;&#10;    printRedBackground();&#10;  &#125; else if (color === &#39;blue&#39;) &#123;&#10;    printBlueBackground();&#10;  &#125; else if (color === &#39;green&#39;) &#123;&#10;    printGreenBackground();&#10;  &#125; else &#123;&#10;    printYellowBackground();&#10;  &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>One way to improve the nested if statement would be using the switch statement. Although it is less verbose and is more ordered, It’s not recommended to use it because it’s so difficult to debug errors, here’s why.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;switch(color) &#123;&#10;  case &#39;black&#39;:&#10;    printBlackBackground();&#10;    break;&#10;  case &#39;red&#39;:&#10;    printRedBackground();&#10;    break;&#10;  case &#39;blue&#39;:&#10;    printBlueBackground();&#10;    break;&#10;  case &#39;green&#39;:&#10;    printGreenBackground();&#10;    break;&#10;  default:&#10;    printYellowBackground();&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>But what if we have a conditional with several checks in each statement? In this case, if we like to do less verbose and more ordered, we can use the conditional switch. If we pass true as parameter to the switch statement, It allows us to put a conditional in each case.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;switch(true) &#123;&#10;  case (typeof color === &#39;string&#39; &#38;&#38; color === &#39;black&#39;):&#10;    printBlackBackground();&#10;    break;&#10;  case (typeof color === &#39;string&#39; &#38;&#38; color === &#39;red&#39;):&#10;    printRedBackground();&#10;    break;&#10;  case (typeof color === &#39;string&#39; &#38;&#38; color === &#39;blue&#39;):&#10;    printBlueBackground();&#10;    break;&#10;  case (typeof color === &#39;string&#39; &#38;&#38; color === &#39;green&#39;):&#10;    printGreenBackground();&#10;    break;&#10;  case (typeof color === &#39;string&#39; &#38;&#38; color === &#39;yellow&#39;):&#10;    printYellowBackground();&#10;    break;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>But we must always avoid having several checks in every condition, avoiding use of switch as far as possible and take into account that the most efficient way to do this is through an object.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;var colorObj = &#123;&#10;  &#39;black&#39;: printBlackBackground,&#10;  &#39;red&#39;: printRedBackground,&#10;  &#39;blue&#39;: printBlueBackground,&#10;  &#39;green&#39;: printGreenBackground,&#10;  &#39;yellow&#39;: printYellowBackground&#10;&#125;;&#10;&#10;if (color &#38;&#38; colorObj.hasOwnProperty(color)) &#123;&#10;  colorObj[color]();&#10;&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/Check-if-a-property-is-in-a-Object/" itemprop="url">
                  Check if a property is in a Object
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:26:57+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/Check-if-a-property-is-in-a-Object/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/Check-if-a-property-is-in-a-Object/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Check if a property is in a Object</p>
<h2 id="the_ambition_is_to_check_if_a_property_is_in_a_Object"><a href="#the_ambition_is_to_check_if_a_property_is_in_a_Object" class="headerlink" title="the ambition is to check if a property is in a Object"></a>the ambition is to check if a property is in a Object</h2><p>When you have to check if a property is present of an object, you probably are doing something like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;var myObject = &#123;&#10;  name: &#39;@tips_js&#39;&#10;&#125;;&#10;&#10;if (myObject.name) &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>Thats ok, but you have to know that there are two native ways for this kind of thing, the in operator and Object.hasOwnProperty, every object descended from Object, has available both ways.<br>See the big Difference</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;var myObject = &#123;&#10;  name: &#39;@tips_js&#39;&#10;&#125;;&#10;&#10;myObject.hasOwnProperty(&#39;name&#39;); // true&#10;&#39;name&#39; in myObject; // true&#10;&#10;myObject.hasOwnProperty(&#39;valueOf&#39;); // false, valueOf is inherited from the prototype chain&#10;&#39;valueOf&#39; in myObject; // true</span><br></pre></td></tr></table></figure>
<p>Both differs in the depth how check the properties, in other words hasOwnProperty will only return true if key is available on that object directly, however in operator doesn’t discriminate between properties created on an object and properties inherited from the prototype chain.</p>
<p>Here another example</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;var myFunc = function() &#123;&#10;  this.name = &#39;@tips_js&#39;;&#10;&#125;;&#10;myFunc.prototype.age = &#39;10 days&#39;;&#10;&#10;var user = new myFunc();&#10;&#10;user.hasOwnProperty(&#39;name&#39;); // true&#10;user.hasOwnProperty(&#39;age&#39;); // false, because age is from the prototype chain</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/Hoisting/" itemprop="url">
                  Hoisting
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T11:25:22+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/01/Hoisting/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/01/Hoisting/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Hoisting<br>Understanding hoisting will help you organize your function scope. Just remember, variable declaration and function definition are hoisted to the top. Variable definition is not, even if you declare and define a variable on the same line. Also, variable declaration is letting the system know that the variable exists while definition is assigning it a value.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#10;function doTheThing() &#123;&#10;  // ReferenceError: notDeclared is not defined&#10;  console.log(notDeclared);&#10;&#10;  // Outputs: undefined&#10;  console.log(definedLater);&#10;  var definedLater;&#10;&#10;  definedLater = &#39;I am defined!&#39;&#10;  // Outputs: &#39;I am defined!&#39;&#10;  console.log(definedLater)&#10;&#10;  // Outputs: undefined&#10;  console.log(definedSimulateneously);&#10;  var definedSimulateneously = &#39;I am defined!&#39;&#10;  // Outputs: &#39;I am defined!&#39;&#10;  console.log(definedSimulateneously)&#10;&#10;  // Outputs: &#39;I did it!&#39;&#10;  doSomethingElse();&#10;&#10;  function doSomethingElse()&#123;&#10;    console.log(&#39;I did it!&#39;);&#10;  &#125;&#10;&#10;  // TypeError: undefined is not a function&#10;  functionVar();&#10;&#10;  var functionVar = function()&#123;&#10;    console.log(&#39;I did it!&#39;);&#10;  &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>To make things easier to read, declare all of your variables at the top of your function scope so it is clear which scope the variables are coming from. Define your variables before you need to use them. Define your functions at the bottom of your scope to keep them out of your way.</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="tuluxmu" />
          <p class="site-author-name" itemprop="name">tuluxmu</p>
          <p class="site-description motion-element" itemprop="description">Front-end engineer。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">33</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/tuluxmu" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tuluxmu</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"your-duoshuo-shortname"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  

  
  


</body>
</html>
